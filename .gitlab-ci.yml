#te
stages:
  - build
  - test
  - deploy
  - release


build_api-gateway:
  stage: build
  image: gradle:latest
  script:
    - cd spring_apps/api-gateway
    - chmod +x gradlew
    - ./gradlew clean build
  artifacts:
    paths:
      - spring_apps/api-gateway/build/libs/*.jar
    expire_in: 1 day
  only:
    refs:
      - main
    changes:
     - spring_apps/api-gateway/**/*

build_user-service:
  stage: build
  image: gradle:latest
  script:
    - cd spring_apps/user-service
    - chmod +x gradlew
    - ./gradlew clean build
  artifacts:
    paths:
      - spring_apps/user-service/build/libs/*.jar
    expire_in: 1 day
  only:
    refs:
      - main
    changes:
     - spring_apps/user-service/**/*

build_garage-service:
  stage: build
  image: gradle:latest
  script:
    - cd spring_apps/garage-service
    - chmod +x gradlew
    - ./gradlew clean build
  artifacts:
    paths:
      - spring_apps/garage-service/build/libs/*.jar
    expire_in: 1 day
  only:
    refs:
      - main
    changes:
     - spring_apps/garage-service/**/*

build_vechicle-service:
  stage: build
  script:
    - cd spring_apps/vehicle-service
    - chmod +x gradlew
    - ./gradlew clean build
  artifacts:
    paths:
      - spring_apps/vehicle-service/build/libs/*.jar
    expire_in: 1 day
  only:
    refs:
      - main
    changes:
     - spring_apps/vehicle-service/**/*

build_notification-service:
  stage: build
  image: gradle:latest
  script:
    - cd spring_apps/notification-service
    - chmod +x gradlew
    - ./gradlew clean build
  artifacts:
    paths:
      - spring_apps/notification-service/build/libs/*.jar
    expire_in: 1 day
  only:
    refs:
      - main
    changes:
     - spring_apps/notification-service/**/*

build_recommendation-service:
  stage: build
  image: gradle:latest
  script:
    - cd spring_apps/recommendation-service
    - chmod +x gradlew
    - ./gradlew clean build
  artifacts:
    paths:
      - spring_apps/recommendation-service/build/libs/*.jar
    expire_in: 1 day
  only:
    refs:
      - main
    changes:
     - spring_apps/recommendation-service/**/*




